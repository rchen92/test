--p
mkdir -p /u01/bak
create pfile='/u01/app/oracle/product/11.1.0/dbhome_1/dbs/init.ora.old' from spfile;
scp /u01/app/oracle/product/11.1.0/dbhome_1/dbs/init.ora.old oracle@192.168.56.16:/u01/app/oracle/product/11.1.0/dbhome_1/dbs/init.ora.old


--s
#export ORACLE_SID=orcl
#mkdir -p /u01/app/oracle/admin/orcl/adump

sqlplus / as sysdba

shutdown immediate
startup nomount pfile='/u01/app/oracle/product/11.1.0/dbhome_1/dbs/init.ora.old'
SQL> select status from v$instance;

STATUS
------------------------------------
STARTED

create spfile from pfile='/u01/app/oracle/product/11.1.0/dbhome_1/dbs/init.ora.old';

alter database mount;
alter database open;

--新参数
--P 相反 
alter system set db_file_name_convert='orcl','orcldg' scope=spfile;                            
--alter system set db_name='orcl' scope=spfile;
--P 不同   
alter system set db_unique_name=orcldg scope=spfile;   
--P 相反
alter system set fal_client='orcldg' scope=spfile; 
--P 相反
alter system set fal_server='orcl' scope=spfile;   
--P不变
alter system set log_archive_config='DG_CONFIG=(orcl,orcldg)' scope=spfile;                              
--alter system set log_archive_dest_1='location=/arch VALID_FOR=(ALL_LOGFILES,ALL_ROLES)   DB_UNIQUE_NAME=orcl' scope=spfile; 
--P 相反 
alter system set log_archive_dest_1='location=use_db_recovery_file_dest VALID_FOR=(ALL_LOGFILES,ALL_ROLES)   DB_UNIQUE_NAME=orcldg' scope=spfile;            
alter system set log_archive_dest_2='SERVICE=orcl ASYNC   VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE) DB_UNIQUE_NAME=orcl' scope=spfile; 
alter system set log_archive_dest_state_1=enable scope=spfile;                  
alter system set log_archive_dest_state_2=enable scope=spfile; 
alter system set log_archive_format='%t_%s_%r.dbf' scope=spfile;                  
alter system set log_archive_max_processes=10 scope=spfile;
--Primary Database: Standby Role Initialization Parameters

alter system set log_file_name_convert='orcl' ,'orcldg'  scope=spfile;
alter system set remote_login_passwordfile=EXCLUSIVE scope=spfile;  
--Primary Database: Standby Role Initialization Parameters
alter system set standby_file_management=auto scope=spfile; 

--alter system set control_files='/data/oradata/o11gr2/control01.ctl', '/data/flash_recovery_area/o11gr2/control02.ctl' scope=spfile;                                
--P 相反                                                                                
  shutdown immediate
   startup nomount



 
  

alter system set db_file_name_convert='orcl','orcldg' scope=spfile;                            
alter system set db_name='orcl' scope=spfile;  
alter system set db_unique_name=orcldg scope=spfile;   
alter system set fal_client='orcldg' scope=spfile; 
alter system set fal_server='orcl' scope=spfile;   
alter system set log_archive_config='DG_CONFIG=(orcl,orcldg)' scope=spfile;                              
alter system set log_archive_dest_1='location=use_db_recovery_file_dest VALID_FOR=(ALL_LOGFILES,ALL_ROLES)   DB_UNIQUE_NAME=orcldg' scope=spfile;            
alter system set log_archive_dest_2='SERVICE=orcl ASYNC   VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE) DB_UNIQUE_NAME=orcl' scope=spfile; 
alter system set log_archive_dest_state_1=enable scope=spfile;                  
alter system set log_archive_dest_state_2=enable scope=spfile; 
alter system set log_archive_format='%t_%s_%r.dbf' scope=spfile;                  
alter system set log_archive_max_processes=10 scope=spfile;
alter system set log_file_name_convert='orcl' ,'orcldg'  scope=spfile;
alter system set remote_login_passwordfile=EXCLUSIVE scope=spfile;  
alter system set standby_file_management=auto scope=spfile; 
alter system set control_files='/data/oradata/o11gr2/control01.ctl', '/data/flash_recovery_area/o11gr2/control02.ctl' scope=spfile; 


