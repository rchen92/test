查看数据库有没有安装
[oracle@ocp-chen ~]$ cat /etc/oratab 
+ASM:/u01/app/11.2.0/grid:N
orcl:/u01/app/oracle/product/11.2.0/db_1:N		# line added by Agent

查看安装了几个数据库
	[oracle@ocp-chen ~]$ dbca
	弹出窗口后，点击configure database options

查看监听是否启动
	$ lsnrctl status
	Listening Endpoints Summary...
	  (DESCRIPTION=(ADDRESS=(PROTOCOL=ipc)(KEY=EXTPROC1521)))
	  (DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=ocp-chen)(PORT=1521)))
	Services Summary...
	Service "+ASM" has 1 instance(s).
	  Instance "+ASM", status READY, has 1 handler(s) for this service...
	Service "orcl.example.com" has 1 instance(s).
	  Instance "orcl", status READY, has 1 handler(s) for this service...
	Service "orclXDB.example.com" has 1 instance(s).
	  Instance "orcl", status READY, has 1 handler(s) for this service...
	The command completed successfully

关闭数据库
	SQL> shutdown immediate
	Database closed.
	Database dismounted.
	ORACLE instance shut down.
启动数据库
	SQL> STARTUP
	ORACLE instance started.

	Total System Global Area 1787138048 bytes
	Fixed Size                  2254104 bytes
	Variable Size            1073744616 bytes
	Database Buffers          704643072 bytes
	Redo Buffers                6496256 bytes
	Database mounted.



~ /home/grid
vi $ORACLE_HOME/network/admin/listener.ora 
# listener.ora Network Configuration File: /u01/app/11.2.0/grid/network/admin/listener.ora
# Generated by Oracle configuration tools.
#static，add by dba
SID_LIST_LISTENER =
  (SID_LIST =
    (SID_DESC =
      (SID_NAME =ocp)
      (ORACLE_HOME =/u01/app/oracle/product/11.2.0/db_1)
      (GLOBAL_DBNAME=ocp)
    )
  )
[oracle@localhost ~]$ echo $ORACLE_HOME
/u01/app/oracle/product/11.2.0/db_1

lsnrctl stop
lsnrctl start
lsnrctl reload

shutdown abort
Service "ocp" has 1 instance(s).
  Instance "ocp", status UNKNOWN, has 1 handler(s) for this service...

sqlplus sys/password@192.168.46.191 as sysdba

sqlplus sys/password@192.168.46.191:1521/ocp as sysdba

sqlplus sys/password@192.168.46.191:1521/ocp as sysdba
sqlplus sys/password@ocp as sysdba

C:\Users\ThinkPad>tnsping ocp

TNS Ping Utility for 32-bit Windows: Version 11.2.0.1.0 - Production on 28-5月 -
2016 11:32:07

Copyright (c) 1997, 2010, Oracle.  All rights reserved.

已使用的参数文件:
c:\app\ThinkPad\product\11.2.0\client_2\network\admin\sqlnet.ora


已使用 TNSNAMES 适配器来解析别名
尝试连接 (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (PROTOCOL = TCP)(HOST = 192.1
68.46.191)(PORT = 1521))) (CONNECT_DATA = (SERVICE_NAME = ocp)))
OK (10 毫秒)

复杂密码
大小写字母+数字+特殊符号(!@#$%&) 长度大于8

vi $ORACLE_HOME/network/admin/sqlnet.ora

TCP.INVITED_NODES=(192.168.186.133,192.168.30.18)
TCP.VALIDNODE_CHECKING=yes

ip:数据库本身ip是白名单,java或c应用服务器,必选
可选:dba的工作电脑


select sys_context('userenv', 'current_user') current_user,
                     sys_context('userenv', 'session_user') session_user,
                    sys_context('userenv', 'current_schema') current_schema,SYS_CONTEXT('USERENV', 'INSTANCE') instance,
                    SYS_CONTEXT('USERENV', 'HOST') host,SYS_CONTEXT('USERENV', 'OS_USER') os_user,SYS_CONTEXT('USERENV', 'IP_ADDRESS') ip_address from dual; 

select sysdate from dual;

TCP.INVITED_NODES=(192.168.46.191)
TCP.VALIDNODE_CHECKING=yes

重启监听
lsnrctl reload

ORA-12537: TNS: 连接关闭

vi $ORACLE_HOME/network/admin/tnsnames.ora

netmgr

OE =
  (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = 192.168.46.191)(PORT = 1521))
    (CONNECT_DATA =
      (SERVER = DEDICATED)
      (SERVICE_NAME = ocp)
    )
  )

CREATE DATABASE LINK dblink_oe
CONNECT TO oe IDENTIFIED BY password
USING 'oe';

SELECT * from ORDERS@dblink_oe;

delete from employees where EMPLOYEE_ID=100;
delete from ORDERS@dblink_oe where rownum=1;
commit;

CREATE DATABASE LINK oe
 CONNECT TO oe
 IDENTIFIED BY password
 USING 'oe';
 
 CREATE DATABASE LINK oe2
 CONNECT TO oe
 IDENTIFIED BY password
 USING ' (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = 192.168.46.191)(PORT = 1521))
    (CONNECT_DATA =
      (SERVER = DEDICATED)
      (SERVICE_NAME = ocp)
    )
  )';

 select sysdate from dual@oe2;

--配置第二个监听
su - grid
vi $ORACLE_HOME/network/admin/listener.ora
old
LISTENER =
  (DESCRIPTION_LIST =
    (DESCRIPTION =
      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1521))
      (ADDRESS = (PROTOCOL = TCP)(HOST = localhost.localdomain)(PORT = 1521))
    )
  )
多加
LISTENER2 =
  (DESCRIPTION_LIST =
    (DESCRIPTION =
      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1521))
      (ADDRESS = (PROTOCOL = TCP)(HOST = localhost.localdomain)(PORT = 1522))
    )
  )  


LISTENER2 =
  (DESCRIPTION_LIST =
    (DESCRIPTION =
      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1522))
      (ADDRESS = (PROTOCOL = TCP)(HOST = localhost.localdomain)(PORT = 1522))
    )
  )  

lsnrctl start LISTENER2

#static,add by dba
SID_LIST_LISTENER2 =
  (SID_LIST =
    (SID_DESC =
      (SID_NAME =ocp)
      (ORACLE_HOME =/u01/app/oracle/product/11.2.0/db_1)
      (GLOBAL_DBNAME=ocp)
    )
  )

lsnrctl reload LISTENER2


开启DCD，只需要在服务端的sqlnet.ora文件中添加SQLNET.EXPIRE_TIME参数，单位为分钟：
vi $ORACLE_HOME/network/admin/sqlnet.ora
SQLNET.EXPIRE_TIME=10 
如果有防火墙，该时间移动要小于防火墙的超时连接。
修改完后重启监听生效。
lsnrctl reload
如果是rac集群，各个节点都要做。
用途1：DCD: Dead Connection Detection ，可以用于检测、标记僵死而没有断开会session，再由PMON进行清理，释放资源( 进程,pga,锁等)。
用途2：防止防火墙的timeout，确保连接池服务器不会由于防火墙的超时设置而断开。






















































