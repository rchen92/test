backtime=`date +"20%y%m%d%H%M%S"`
expdp rman/rman schemas=sgeapp dumpfile=expdp_`date +%Y%m%d`_%U.dmp DIRECTORY=dpdata compression=all logfile=expdp_$backtime.log  parallel=4;
find /oradata/backup/expdp/ -name "*.dmp" -mtime +7 -exec rm {} \;
chmod -R o+r /oradata/backup/expdp



impdp sgeapp/sgeapp directory=dpdata dumpfile=expdp_20180716_160001.dmp REMAP_SCHEMA=sgeapp:sgeapp REMAP_TABLESPACE=TBS_SGEAPP:TBS_SGEAPP   table_exists_action=replace logfile=impdb0724.log;


create tablespace TBS_SGEAPP datafile '/oradata/sgeapp/sgeapp.dbf' size 30000m autoextend off extent management local segment space management auto;
alter tablespace TBS_SGEAPP add datafile '/oradata/sgeapp/sgeapp2.dbf' size 30000m autoextend off ;
alter tablespace TBS_SGEAPP add datafile '/oradata/sgeapp/sgeapp3.dbf' size 30000m autoextend off ;
alter tablespace TBS_SGEAPP add datafile '/oradata/sgeapp/sgeapp4.dbf' size 30000m autoextend off ;
alter tablespace TBS_SGEAPP add datafile '/oradata/sgeapp/sgeapp5.dbf' size 30000m autoextend off ;


create user SGEAPP identified by sgeapp default tablespace TBS_SGEAPP ;
grant create session TO SGEAPP;
grant create any table TO SGEAPP;
grant connect,resource TO SGEAPP;


alter user sgeapp identified by sgeapp;


create or replace directory dpdata as '/oradata/oradb';
grant read,write on directory dpdata to sgeapp;
impdp system/oracle directory=dpdata dumpfile=expdp_20180716_160001.dmp REMAP_SCHEMA=sgeapp:sgeapp REMAP_TABLESPACE=TBS_SGEAPP:TBS_SGEAPP   table_exists_action=replace logfile=impdb0724.log;

impdp system/oracle parallel=4 directory=dpdata dumpfile=expdp_20180716_%U.dmp REMAP_SCHEMA=sgeapp:sgeapp REMAP_TABLESPACE=TBS_SGEAPP:TBS_SGEAPP   table_exists_action=replace logfile=impdb0729.log;



drop user sgeapp cascade;
drop tablespace SGEAPP including contents and datafiles cascade constraint;




select  count(1), '现货成交笔数',sum(F_VOLUME) ,'现货成交手数' as 手数  from V_APP_TRA_HIS_TRANSACTION t,t_app_bsc_seat s 
WHERE T.F_INST_NAME='SPOTINST' and t.f_match_date=to_char(sysdate-2,'yyyyMMdd') and t.f_seat_id=RPAD(s.f_seat_id,8);



impdp sgeapp/sgeapp directory=dpdata dumpfile=expdpXXXXXXXXXXXXXXXXXXX.dmp REMAP_SCHEMA=sgeapp:sgeapp REMAP_TABLESPACE=TBS_SGEAPP:TBS_SGEAPP   table_exists_action=replace logfile=impdb20180729.log;


select name,dbid from v$database;












